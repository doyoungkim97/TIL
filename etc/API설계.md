# RESTful API 설계 - 이해편

## 1. REST API

- ### REST
웹 어플리케이션을 개발하기 위한 아키텍처 스타일중 하나
Client / Server간의 **통신 규정**
**HTTP 프로토콜**을 기반으로 **자원, 행위, 표현** 세가지의 요소로 구성

- ### REST API
REST 아키텍처 스타일로 구성된 API를 의미

- ### RESTful API
HTTP를 위한 아키텍처 스타일
REST원칙을 따르는 웹 서비스를 구현하는 방식이며 웹 서비스를 개발하는 방식
> 클라이언트와 서버간 자원을 주고받을때 일괄적인 방식을 제공해서 서버와 클라이언트의 역할을 명확하게 분리, 이를 통해 독립적 개발 가능

### ✅용어 설명
#### 프로토콜
클라이언트와 서버간의 약속된 통신 규칙

#### REST API vs RESTful API
REST API는 REST 아키텍처 스타일을 따르는 API
RESTful은 REST API를 제공하는 웹 서비스를 의미
👉 RESTful API는 REST API원칙을 따르기 때문에 **RESTful** 하다

#### RESTful하다란?
>REST API 원칙을 따라 구상한 웹 서비스를 의미

자원을 URL로 표현, HTTP 메소드를 이용해서 해당 자원에 대해 CRUD를 수행
리소스와 행위를 명시적으로 분리해서 사용함으로 URL을 통해서 어떤 작업을 하는지 알 수 있는 상태

#### API (Application Programming Interface)
응용 프로그램에서 사용할 수 있는 인터페이스를 의미
프로그램간의 상호작용을 위함

### 🛑 RESTful API 제약조건
#### 1. 클라이언트 서버 아키텍처
클라이언트와 서버 간의 **엄격한 분리**와 **독립성**을 유지
각각의 역할이 명확히 구분되어 서로에게 영향 X

#### 2. 상태 없음 (stateless)
상태를 관리하지 않는다. 클라이언트의 요청에 서버가 응답을 반환하는데 이때 클라이언트의 세션 정보, 상태를 관리하지 않음
확장성이 높아지고 클라이언트와 서버간의 의존성 Down

ex) 클라이언트가 리퀘스트 보내고 다운되고 걍 서버는 받아라 하고 보냄

#### 3. 캐시 가능
캐시를 사용할 수 있어야한다.
서버의 응답이 캐시 가능하다면 클라이언트는 서버에 요청하여 응답을 받는 대신 캐시에 바로 응답 가능
> 추가 이해 필요

#### 4. 계층구조
계층 구조로 구성되야함
클라이언트와 서버간의 미들웨어를 추가해서 보안, 로드밸런싱, 공유 캐시등 기능 추가

#### 5. 인터페이스 일관성
인터페이스 일관성을 유지해야한다.
서버 클라이언트간의 상호작용 단순화 및 의존성 Down

#### 6. 자체 표현성
클라이언트는 서버로 받은 응답을 해석해야하며, 서버는 클라이언트 응답에 따라 적절한 리퀘스트를 제공해야함

## 2. RESTful API 설계
> 1. 자원(Resource) 을 정의한다.
2. 행위(HTTP Method) 를 정의한다.
3. 표현(Representation)을 정의
4. 상태코드(Status code)를 정의
5. API를 문서화

### REST 3가지 요소
#### 1. 자원(Resource)
웹 상에 존재하는 데이터나 정보와 같은 모든 것을 의미
사용자, 게시글, 댓글, 이미지 등 모두 자원의 예시
자원의 이름 구성 동사가 아닌 명사 사용을 권장, 동사를 쓰면 URL 길이 증가

#### 2. 행위(Verb)
HTTP Method을 잉요한 자원에 대한 행위(조회,생성,수정, 삭제) 의미
CRUD 기능을 하는 것을 의미한다.

|메소드|행위|설명|Example|
|-----|----|----|-----|
|GET|조회| URL로 지정된 정보 검색|사용자 정보 조회: GET /users/{user_id}|
|POST|생성| URL로 지정된 위치에 자원 생성|사용자 정보 생성: POST /users|
|PUT|수정|  URL로 지정위치 자원 갱신|사용자 정보 수정: PUT /users/{user_id}|
|DELETE|삭제| URL로 지정된 위치 자원 삭제|사용자 정보 삭제: DELETE /users/{user_id}|
|PATCH|일부 수정| URL로 지정된 위치 리소스 일부 수정|사용자 이메일 수정 : PATCH /users/{user_id}|

##### ❓ PUT,PATCH 는 뭔차이지?
> PUT은 전체 리소스를 교체하고 PATCH 는 일부를 수정한다.
전체 리소스를 변경하는 것은 모든 정보를 완전히 교체하는가 일부만 수정하는 가의 차이점
이를 위해서 리소스의 수정 내용을 포함하는 요청 본문 전송

 #### 3. 표현(Representation)
 서버간의 데이터를 주고받은 데이터 형식을 의미한다.
 JSON, XML, HTML
 3가지 경우에 대한 각각의 용도와 사용처가 있지만
 내 기억에 레거시가 대부분 XML이었고 나는 실제 API로는 JSON만 사용
 
 ### 상태 코드(Status code)
 클라이언트에게 요청의 성공 및 실패 여부를 전달
 흔히 404와 같은 3자리의 상태코드를 전달
 
 - 자릿수에 따른 상태 코드
 ![](https://velog.velcdn.com/images/kimdodo/post/8583b8da-3f87-4e96-82c7-ddf9a3f5978c/image.png)
 
 - 범용적 상태코드
 ![](https://velog.velcdn.com/images/kimdodo/post/b94cc351-30ae-459c-89fa-b2e8a395410a/image.png)

### API 문서화
API 문서화는 반드시 필요하다 
응용 프로그램 유저에세 3rd Party 제공 내부적, 외부적으로 문서화가 되지 않으면 API 사용이 어려움

API의 자원, 메소드, 표현, 상태코드, 응답 형태 등 상세내용을 기술
클라이언트와 서버간의 일고나적인 자원 교환 형식을 문서를 통해서 규격화 하여 유지보수성이 높아짐

#### 1. API EndPoint 설정
요청을 보내는 URL을 의미한다.
>예를 들어 https://blog.naver.com/panic9861/223300444494 이런 URL을 해석해보자면 네이버 블로그의 panic9861 유저의 223300444494라는 글을 GET해서 읽어오는 것이라고 판단된다.
![](https://velog.velcdn.com/images/kimdodo/post/727ab986-7de2-4f6a-b43c-a476c2f5ce79/image.png)

#### 2. API EndPoint 문서화
엔드포인트에서의 기능과 사용방법을 문서화
아래 5개의 내용을 기술해야한다.
![](https://velog.velcdn.com/images/kimdodo/post/4bb7185f-2e77-4abd-a3d2-cb5d5d0d4399/image.png)
>이 과정은 각 개발언어의 문서화 도구 라이브러리를 통해 생산성 증가 가능


이렇게 RESTful API문서를 어떤식으로 설계해야하는지를 이해 했다.
다음에는 SPring에서는 어떻게 API를 만들고 사용하는지를 한번 알아보자