# 주문 도메인 설계 및 구현
> 💻 스프링 핵심 기술 - 기초
해당 강의는 김영한님의 스프링 핵심 원리- 기초 강의를 수강하여 공부한 내용은 간략하게 기록하는 기록장
[스프링 핵심 원리 기초 강의](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC-%EA%B8%B0%EB%B3%B8%ED%8E%B8#)

## 주문&할인 도메인 설계
### 주문&할인 정책
- 회원은 상품을 주문
- 회원 등급에 따라 할인 정책 적용
- 할인 정책은 모든 VIP는 1000원을 할인해주는 고정 금액 할인을 적용(추후 변경)
- 할인 정책은 변동성 높음, 회사의 내규 X, 최종 결정 딜레이 (캔슬 가능)

### 주문 도메인 협력-역할-책임
![](https://velog.velcdn.com/images/kimdodo/post/aa3d6cd7-c1c4-477f-a3db-aa1e387517c6/image.png)
위의 과정은 클라이언트가 주문을 했을때 클라이언트 정보를 확인하고 할인 정책 적용을 마친 최종 주문 결과를 리턴해주는 과정

- #### 1.주문 생성
클라이언트는 주문 서비스에 주문 생성을 요청
- #### 2. 회원 조회
할인을 위해서 회원등급을 조회하기 위해 회원 저장소에서 회원 조회
- #### 3. 할인 적용
주문 서비슨느 등급에 따른 할인 여부를 할인 정책에 위임
- #### 4. 주문 결과 반환
주문 서비스는 할인 결과를 포함한 주문 결과 리턴

> 각각 주문 역할 인터페이스, 할인 정책, 저장소 인터페이스를 통한 3개의 구현체가 실제로 운용될 것으로 보여진다.

### 주문 도메인 전체 플로우
![](https://velog.velcdn.com/images/kimdodo/post/d594ebe5-8654-4bc1-a11d-fbb398414bd7/image.png)
역할에 따른 구현체를 가지고 있다. 유연하게 필요에 따른 구현체를 조립하면 되는 것이다. 
정률 할인 정책을 사용하면 정률을, 정액 할인 정책이 필요하면 정액 할인 구현체를!!

### 클래스 다이어그램
![](https://velog.velcdn.com/images/kimdodo/post/25e26e38-4490-4366-8868-fd2291dae7a8/image.png)

### 객체 다이어그램
![](https://velog.velcdn.com/images/kimdodo/post/3c12f0ee-4d7e-4c1c-89fc-59c28549e974/image.png)
![](https://velog.velcdn.com/images/kimdodo/post/720dcaf3-b9bf-409d-80ea-a97f45de7790/image.png)

결국 각 역할이 고정되어 있고 구현체를 통해서 구현 내용을 변화시키기 떄문에
위 그림의 예시처럼 주문 서비스 구현체 자체는 변화가 없다.

그럼 이렇게 잘 구현된 예제는 현재 메모리,정액 할인 정책인데
이걸 정률, DB로 변경시에는 어떻게 되는가를 확인해보자

이때 잘 되지 않는다면 그때 어떤 문제가 있는지 한번 확인해보자!